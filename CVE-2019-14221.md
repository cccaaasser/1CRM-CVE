Information
---
```
Product             : 1CRM On-Premise Software
Vulnerability Name  : Stored Cross-Site Scripting
version             : 8.5.7
Fixed on            : 8.5.10
Test on             : CentOS 7.6.1810 (Core)
Reference           : https://1crm.com
CVE-Number          : CVE-2019-14221
```

Description
---
1CRM On-Premise Software 8.5.7 allows XSS via a payload that is mishandled during a Run Report operation.

PoC
---
**Attacker**
1. Login as any user
2. Click Email icon
3. Click Report
4. Click Create Report

![1](/resources/1.png)

5. Fill Report Name
6. Assign to Victim (In this example we assigned to admin)

![2](/resources/2.png)

7. Click Column Layout
8. Click Add empty column

![3](/resources/3.png)

9. Input malicious code (ex. ```<script>alert(document.cookie);</script>```)

![4](/resources/4.png)

10. Click Save

![5](/resources/5.png)

**Victim**
1. Click email icon
2. Click Report
3. Choose report that we recently created

![6](/resources/6.png)

4. Click Run Report

![7](/resources/7.png)

5. Admin cookie will popup

![8](/resources/8.png)

PoC Video
---
https://youtu.be/hfqgPatMLRc

# Credit
Kusol Watchara-Apanukorn (SHA999)

# References
https://nvd.nist.gov/vuln/detail/CVE-2019-14221
